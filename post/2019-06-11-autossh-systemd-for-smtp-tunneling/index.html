<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Using autossh, systemd and restirected ssh forwarding for tunneling SMTP</title>
		<meta name="viewport" content="width=device-width">
		
		<link rel="stylesheet" href="http://anydot.in/css/hybrid.css">
		<link rel="stylesheet" href="http://anydot.in/css/style.css">
		<link rel="stylesheet" href="http://anydot.in/css/colors-dark.css">

		
	</head>
	<body>
		<header id="header">
			<h1><a href="http://anydot.in/">Anydot&#39;s blog</a></h1>
			<p></p>
		</header>

		<div id="page">
			<div id="sidebar">
				<nav>
	
		<ul class="nav">
			
				<li><a href="https://www.linkedin.com/in/p%C5%99emysl-hrub%C3%BD-aa340539/"><span>LinkedIn</span></a></li>
			
				<li><a href="/index.xml"><span>RSS Feed</span></a></li>
			
				<li><a href="https://twitter.com/anydot"><span>Twitter</span></a></li>
			
		</ul>
	
</nav>

			</div>

			<div id="content">
				
	<article class="post">
		<h1><a href="http://anydot.in/post/2019-06-11-autossh-systemd-for-smtp-tunneling/">Using autossh, systemd and restirected ssh forwarding for tunneling SMTP</a> </h1>

		<div class="post-content"><p>I didn&rsquo;t want to turn a full-blow MTA on my RaspberryPI and decided to give the Dragonfly MTA a try. Unfortunately my home DSL line IP block is properly marked as
a dial-up line and thus Google rejects all the emails I&rsquo;m trying to send to myself :)</p>
<pre><code>root@raspberrypi:~# cat /etc/systemd/system/autossh-smtp.service
[Unit]
Description=AutoSSH target to run the SMTP forwarding to oratica
After=network.target

[Service]
Environment=&quot;AUTOSSH_GATETIME=0&quot;
ExecStart=/usr/bin/autossh -M 0 -o &quot;ServerAliveInterval 30&quot; -o &quot;ServerAliveCountMax 3&quot; -T -N -i /root/.ssh/id_ed25519_smtp_smarthost -p 30022 -L 25:127.0.0.1:25 prema@oratica.anydot.in

[Install]
WantedBy=multi-user.target
root@raspberrypi:~# systemctl daemon-reload
root@raspberrypi:~# systemctl start autossh-smtp.service
root@raspberrypi:~# systemctl enable autossh-smtp.service
Created symlink /etc/systemd/system/multi-user.target.wants/autossh-smtp.service â†’ /etc/systemd/system/autossh-smtp.service.
</code></pre><pre><code>Authorized keys
restrict,port-forwarding,permitopen=&quot;127.0.0.1:25&quot;,command=&quot;/bin/true&quot; ssh-ed25519 AAAremoveZGtA root@raspberrypi
</code></pre></div>

		<p class="meta">Posted on <span class="postdate">11. June 2019</span></p>
	</article>

			</div>

			<footer id="footer">
				<p class="copyright">Powered by
					<a href="https://gohugo.io/">Hugo</a> and the
					<a href="https://github.com/bake/solar-theme-hugo">Solar</a>-theme.</p>
			</footer>
		</div>

		
	</body>
</html>
